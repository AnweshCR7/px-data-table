var minidata = [
  {
    "first": "Valentine",
    "last": "Meyer",
    "image": "https://s3.amazonaws.com/uifaces/faces/twitter/iboldurev/73.jpg",
    "boolean": true,
    "guid": "8c3bd9ad-e8d6-4ea4-85e6-d145295f3f91",
    "integer": 99,
    "date": "Sat Feb 17 1973 03:45:57 GMT-0800 (PST)",
    "address": "4 Whitty Lane",
    "city": "Nicholson",
    "state": "South Carolina",
    "zip": 41343,
    "country": "Germany",
    "email": "valentinemeyer@scentric.com",
    "phone": "(956) 428-2996",
    "color": "<button class='btn' style='color:rgb(201,142,97);'>Blue Bottle cardigan</button>"
  },
  {
    "first": "Silva",
    "last": "Alexander",
    "image": "https://s3.amazonaws.com/uifaces/faces/twitter/smalonso/73.jpg",
    "boolean": true,
    "guid": "37224065-ac71-4716-be9a-108ecddfee47",
    "integer": 16,
    "date": "Wed Aug 02 1995 07:03:12 GMT-0700 (PDT)",
    "address": "2 Berkeley Place",
    "city": "Manila",
    "state": "Michigan",
    "zip": 22009,
    "country": "Thailand",
    "email": "silvaalexander@gmail.com",
    "phone": "(823) 415-2224",
    "color": "<button class='btn' style='color:rgb(113,105,251);'>Freegan tilde</button>"
  },
  {
    "first": "Hopkins",
    "last": "Wong",
    "image": "https://s3.amazonaws.com/uifaces/faces/twitter/taherrapee/73.jpg",
    "boolean": false,
    "guid": "1ea0922e-179d-4057-abeb-d8fe63e55da8",
    "integer": 94,
    "date": "Wed Sep 21 2011 04:03:55 GMT-0700 (PDT)",
    "address": "4 Tompkins Avenue",
    "city": "Movico",
    "state": "Maine",
    "zip": 89440,
    "country": "Seychelles",
    "email": "hopkinswong@hotmail.com",
    "phone": "(814) 488-2063",
    "color": "<button class='btn' style='color:rgb(133,126,66);'>bespoke gastropub</button>"
  },
  {
    "first": "Harriet",
    "last": "Sherman",
    "image": "https://s3.amazonaws.com/uifaces/faces/twitter/ismailmayat/73.jpg",
    "boolean": true,
    "guid": "46a4a1bc-97af-46e0-aedd-c3cc42e6b8f5",
    "integer": 27,
    "date": "Wed Jul 07 2010 05:48:57 GMT-0700 (PDT)",
    "address": "3 Stratford Road",
    "city": "Makena",
    "state": "Kansas",
    "zip": 21389,
    "country": "Chad",
    "email": "harrietsherman@scentric.com",
    "phone": "(887) 497-3612",
    "color": "<button class='btn' style='color:rgb(195,89,110);'>dreamcatcher fingerstache</button>"
  },
  {
    "first": "Stacie",
    "last": "Bartlett",
    "image": "https://s3.amazonaws.com/uifaces/faces/twitter/carlyson/73.jpg",
    "boolean": false,
    "guid": "17aac57d-4644-44d8-8a6b-b2eedd3d42dc",
    "integer": 49,
    "date": "Sun Mar 14 1999 23:13:33 GMT-0800 (PST)",
    "address": "4 Luquer Street",
    "city": "Newcastle",
    "state": "Iowa",
    "zip": 72190,
    "country": "Uruguay",
    "email": "staciebartlett@scentric.com",
    "phone": "(957) 412-3261",
    "color": "<button class='btn' style='color:rgb(164,84,221);'>Etsy beard</button>"
  },
  {
    "first": "Lindsay",
    "last": "Meyer",
    "image": "https://s3.amazonaws.com/uifaces/faces/twitter/iboldurev/73.jpg",
    "boolean": true,
    "guid": "8c3bd9ad-e8d6-4ea4-85e6-d145295f3f91",
    "integer": 99,
    "date": "Sat Feb 17 1973 03:45:57 GMT-0800 (PST)",
    "address": "4 Whitty Lane",
    "city": "Nicholson",
    "state": "South Carolina",
    "zip": 41343,
    "country": "Germany",
    "email": "lindsay@gmail.com",
    "phone": "(956) 428-2996",
    "color": "<button class='btn' style='color:rgb(201,142,97);'>Austin meggings</button>"
  },
  {
    "first": "Shelley",
    "last": "Alexander",
    "image": "https://s3.amazonaws.com/uifaces/faces/twitter/smalonso/73.jpg",
    "boolean": true,
    "guid": "37224065-ac71-4716-be9a-108ecddfee47",
    "integer": 16,
    "date": "Wed Aug 02 1995 07:03:12 GMT-0700 (PDT)",
    "address": "2 Berkeley Place",
    "city": "Manila",
    "state": "Michigan",
    "zip": 22009,
    "country": "Thailand",
    "email": "shelley@hotmail.com",
    "phone": "(823) 415-2224",
    "color": "<button class='btn' style='color:rgb(113,105,251);'>Kitsch banjo</button>"
  },
  {
    "first": "Rita",
    "last": "Wong",
    "image": "https://s3.amazonaws.com/uifaces/faces/twitter/taherrapee/73.jpg",
    "boolean": false,
    "guid": "1ea0922e-179d-4057-abeb-d8fe63e55da8",
    "integer": 94,
    "date": "Wed Sep 21 2011 04:03:55 GMT-0700 (PDT)",
    "address": "4 Tompkins Avenue",
    "city": "Movico",
    "state": "Maine",
    "zip": 89440,
    "country": "Seychelles",
    "email": "rita@yahoo.com",
    "phone": "(814) 488-2063",
    "color": "<button class='btn' style='color:rgb(133,126,66);'>Brooklyn authentic</button>"
  },
  {
    "first": "Joe",
    "last": "Sherman",
    "image": "https://s3.amazonaws.com/uifaces/faces/twitter/ismailmayat/73.jpg",
    "boolean": true,
    "guid": "46a4a1bc-97af-46e0-aedd-c3cc42e6b8f5",
    "integer": 27,
    "date": "Wed Jul 07 2010 05:48:57 GMT-0700 (PDT)",
    "address": "3 Stratford Road",
    "city": "Makena",
    "state": "Kansas",
    "zip": 21389,
    "country": "Chad",
    "email": "joejoe@yahoo.com",
    "phone": "(887) 497-3612",
    "color": "<button class='btn' style='color:rgb(195,89,110);'>Pickled cray scenester</button>"
  },
  {
    "first": "Jane",
    "last": "Bartlett",
    "image": "https://s3.amazonaws.com/uifaces/faces/twitter/carlyson/73.jpg",
    "boolean": false,
    "guid": "17aac57d-4644-44d8-8a6b-b2eedd3d42dc",
    "integer": 49,
    "date": "Sun Mar 14 1999 23:13:33 GMT-0800 (PST)",
    "address": "4 Luquer Street",
    "city": "Newcastle",
    "state": "Iowa",
    "zip": 72190,
    "country": "Uruguay",
    "email": "jane@scentric.com",
    "phone": "(957) 412-3261",
    "color": "<button class='btn' style='color:rgb(164,84,221);'>8-bit migas</button>"
  }
];

suite('Remote Data Paradigm', function () {
  test('Polymer exists', function() {
    assert.isTrue(Polymer !== null);
  });
});

  // ------------------------------------------
  // Table 1 Tests
  // ------------------------------------------
suite('Page 1 - remoteData1', function (done) {
  let currentTableFixture;
  let paginationControl;
  let tableInner;
  setup(function (done) {
    currentTableFixture = fixture('remoteData1');
    currentTableFixture.tableData = minidata;
    flush(function () {
      tableInner = Polymer.dom(currentTableFixture.root).querySelector('aha-table');
      paginationControl = Polymer.dom(tableInner.root).querySelector('px-pagination');
      done();
    });
  });

  test('fixture is created', function() {
    assert.isTrue(currentTableFixture !== null);
  });

  test('Default pagination size is 10', function(){
    assert.equal(currentTableFixture.pageSize, 10, 'Default page size should be 10 rows.');
  });

  test('Default rows displayed size is 10', function(){
    let rowCount = Polymer.dom(tableInner.root).querySelectorAll('.rows').length;
    assert.equal(rowCount, 10, 'Default rows displayed should be 10 rows.');
  });

  test('Pagination shows 1-10 of 100', function(){
    var paginationSpan = Polymer.dom(paginationControl.root).querySelector('.summary');
    var paginationTextString = paginationSpan.textContent.replace(/\s\s*/g,' ').trim();
    assert.equal(paginationTextString, '1-10 of 100', 'Shows correct pagination counts.');
  });

  test('Page 1 should be selected', function(){
    assert.equal(Polymer.dom(paginationControl.root).querySelector('.btn--tertiary').textContent, '1',
      '"1" is the selected page in the pagination component');
  });

  test('Page 2 should NOT be selected', function(){
    assert.equal(Polymer.dom(paginationControl.root).querySelectorAll('.btn--tertiary').length, 1,
      'No other page number is selected');
  });

  test('Clicking Next Page button fires a `px-page-change-intent` event', function(done) {
    var pageChangeButton = Polymer.dom(paginationControl.root).querySelector('#next');
    currentTableFixture.addEventListener('px-page-change-intent', (evt) => {
      assert(true, 'Event is triggered');
      assert.equal(parseInt(evt.detail,10), 2, 'Requesting page 2');
      done();
    });
    pageChangeButton.click();
  });

  test('Updating properties triggers appearance of Page 2', function() {
    let page = 2;

    currentTableFixture.firstItemIndex = 11;
    currentTableFixture.totalEntries = 50;

    let paginationSpan = Polymer.dom(paginationControl.root).querySelector('.summary');
    let paginationTextString = paginationSpan.textContent.replace(/\s\s*/g,' ').trim();
    assert.equal(paginationTextString, '11-20 of 50', 'Shows correct pagination counts.');

    assert.equal(Polymer.dom(paginationControl.root).querySelector('.btn--tertiary').textContent, '2',
    'Page 2 is selected');
  });
});


// ------------------------------------------
// Page 2 Tests
// ------------------------------------------
suite('Page 2 - remoteData2', (done)=> {
  let currentTableFixture;
  let paginationControl;
  let tableInner;
  setup(done => {
    currentTableFixture = fixture('remoteData2');
    currentTableFixture.tableData = minidata;
    flush(function () {
      tableInner = Polymer.dom(currentTableFixture.root).querySelector('aha-table');
      paginationControl = Polymer.dom(tableInner.root).querySelector('px-pagination');
      done();
    });
  });


  test('fixture is created', ()=> {
      assert.isTrue(currentTableFixture !== null);
  });

  test('Default pagination size is 10', ()=>{
    assert.equal(currentTableFixture.pageSize, 10, 'Default page size should be 10 rows.');
  });

  test('Default rows displayed size is 10', ()=>{
    let tb = Polymer.dom(currentTableFixture.root).querySelector('aha-table'),
        rowCount = Polymer.dom(tb.root).querySelectorAll('.rows').length;
    assert.equal(rowCount, 10, 'Default rows displayed should be 10 rows.');
  });

  test('Pagination shows 11-20 of 100', ()=>{
    let paginationSpan = Polymer.dom(paginationControl.root).querySelector('.summary');
    let paginationTextString = paginationSpan.textContent.replace(/\s\s*/g,' ').trim();

    assert.equal(paginationTextString, '11-20 of 100', 'Shows correct pagination counts.');
  });

  test('Page 2 should be selected', ()=>{
    assert.equal(Polymer.dom(paginationControl.root).querySelector('.btn--tertiary').textContent, '2',
    '"2" is the selected page in the pagination component');
  });

  test('Page 1 should NOT be selected', ()=>{
    assert.equal(Polymer.dom(paginationControl.root).querySelectorAll('span.btn--bare')[0].textContent, 1,
      'Page 1 isn\'t selected');
  });

  test('Clicking Previous Page button fires a `px-page-change-intent` event', done => {
    let pageChangeButton = Polymer.dom(paginationControl.root).querySelector('#previous');

    currentTableFixture.addEventListener('px-page-change-intent', evt => {
      assert(true, 'Event is triggered');
      assert.equal(parseInt(evt.detail,10), 1, 'Requesting page 1');
      done();
    });

    pageChangeButton.click();
  });

  test('Updating properties triggers appearance of Page 1', done => {
    let page = 1;
    let dataTable = currentTableFixture;

    dataTable.firstItemIndex = 1;
    dataTable.totalEntries = 50;
    flush(()=>{
      let paginationSpan = Polymer.dom(paginationControl.root).querySelector('.summary');
      let paginationTextString = paginationSpan.textContent.replace(/\s\s*/g,' ').trim();

      assert.equal(paginationTextString, '1-10 of 50', 'Shows correct pagination counts.');
      assert.equal(Polymer.dom(paginationControl.root).querySelector('span.btn--tertiary').textContent, 1, 'Page 1 is selected');
      done();
    });
  });
});

  //
  // });
  //
  // // ------------------------------------------
  // // Rows per Page Dropdown Tests
  // // ------------------------------------------
  // suite('Rows per Page Dropdown - remoteData3', function () {
  //
  //   setup(function (done) {
  //     currentTableFixture = fixture('remoteData3');
  //     currentTableFixture.tableData = minidata;
  //     this.timeout(20*1000); // adding table data may take a while
  //     flush(function () { done(); });
  //   });
  //
  //   teardown(function () { });
  //
  //   test('fixture is created', function(done) {
  //     flush(function () {
  //       assert.isTrue(currentTableFixture !== null);
  //       done();
  //     });
  //   });
  //
  //   test('On change, it fires a `px-page-size-change-intent` event', function(done) {
  //     var dataTable = currentTableFixture;
  //     var paginationElement = dataTable.querySelector('.pagination px-pagination#pagination');
  //     // var pageSizeSelectDropdown = dataTable.querySelector('.pagination px-pagination#pagination px-dropdown');
  //
  //     dataTable.addEventListener('px-page-size-change-intent', (evt) => {
  //       assert(true, 'Event is triggered');
  //       var val = _typeofComparison(evt.detail, "string") ? parseInt(evt.detail,10) : evt.detail;
  //       assert.equal(val, 10, 'Requesting page size of 10');
  //       done();
  //     });
  //
  //     // TODO: figure out how to trigger this on the pageSizeSelectDropdown
  //     // can't currently trigger a bubbling event (in IE11 only) on the dropdown that bubbles to px-pagination
  //     //   because simulated events are strictly {bubbles:false} with readonly on that property
  //     // simulateEvent(pageSizeSelectDropdown, 'selected-changed');
  //
  //     // ATTEMPTS
  //     // pageSizeSelectDropdown.fire('selected-changed', 'dummyParam', {cancelable: true});
  //     // var selectedChangedEvt = new Event('selected-changed');
  //     // pageSizeSelectDropdown.dispatchEvent(selectedChangedEvt);
  //
  //     // because this a px-* component, you can't mutate the selected item with js
  //     // so we have to expect the value to be what is currently selected
  //     // this could be improved by changing the dropdown value with clicks
  //     paginationElement.value = 10;
  //     // simulateEvent(paginationElement, 'selected-changed', {target:{value:10}});
  //     paginationElement.dispatchEvent(new Event('selected-changed'), {target:{value:10}});
  //
  //   });
  //
  //
  //   test('Updates value accordingly when value is passed in', function() {
  //     var dataTable = currentTableFixture;
  //     var pageSizeSelectDropdown = dataTable.querySelector('.pagination px-pagination#pagination px-dropdown');
  //
  //     dataTable.pageSize = 20;
  //     dataTable.totalEntries = 100;
  //
  //     assert.equal(pageSizeSelectDropdown.selected, 20);
  //
  //     var paginationSpan = dataTable.querySelector('.summary.px-pagination');
  //     var paginationTextString = paginationSpan.textContent.replace(/\s\s*/g,' ').trim();
  //     assert.equal(paginationTextString, '1-20 of 100', 'Shows correct pagination counts.');
  //   });
  //
  // });
  //
  // // ------------------------------------------
  // // Filtering Tests
  // // ------------------------------------------
  // suite('Filtering - remoteDataFiltering1', function () {
  //
  //   var currentTableFixture2;
  //
  //   setup(function (done) {
  //     currentTableFixture = fixture('remoteDataFiltering1');
  //     currentTableFixture.tableData = minidata;
  //
  //     currentTableFixture2 = fixture('remoteDataFiltering2');
  //     currentTableFixture2.tableData = minidata;
  //
  //
  //     this.timeout(20*1000); // adding table data may take a while
  //     flush(function () { done(); });
  //   });
  //
  //   teardown(function () { });
  //
  //   test('fixture is created', function(done) {
  //     flush(function () {
  //       assert.isTrue(currentTableFixture !== null);
  //       assert.isTrue(currentTableFixture2 !== null);
  //       done();
  //     });
  //   });
  //
  //   test('Send event with combined filter string for one column', function (done) {
  //
  //       var dataTable = currentTableFixture;
  //       var lastNameFilterSelector = 'div > div.tr.tr--filter > :nth-child(2) > input';
  //       var lastNameFilter = dataTable.querySelector(lastNameFilterSelector);
  //
  //       dataTable.addEventListener('px-filter-change-intent', (evt) => {
  //         assert(true, 'Event is triggered');
  //         assert.equal(evt.detail, '[{"name":"last","userEntry":"ab"}]', 'Requesting filter change');
  //         done();
  //       });
  //
  //       lastNameFilter.value = 'ab';
  //       lastNameFilter.dispatchEvent(new Event('input'));
  //   });
  //
  //   test('Send event with combined filter string for all columns', function (done) {
  //
  //       var filters = [{name:'first', userEntry:'ab'}, {name:'last', userEntry:'cd'}];
  //
  //       var dataTable = currentTableFixture2;
  //       var ahaTable = dataTable.querySelector('#dataTable');
  //
  //       var firstNameFilterSelector = 'div > div.tr.tr--filter > :nth-child(1) > input';
  //       var firstNameFilter = dataTable.querySelector(firstNameFilterSelector);
  //
  //       var lastNameFilterSelector = 'div > div.tr.tr--filter > :nth-child(2) > input';
  //       var lastNameFilter = dataTable.querySelector(lastNameFilterSelector);
  //
  //       var imageFilterSelector = 'div > div.tr.tr--filter > :nth-child(3) > input';
  //       var imageFilter = dataTable.querySelector(imageFilterSelector);
  //
  //       dataTable.addEventListener('px-filter-change-intent', (evt) => {
  //         assert(true, 'Event is triggered');
  //         assert.equal(evt.detail, JSON.stringify(filters), 'Requesting filter change on multiple columns');
  //         done();
  //       });
  //
  //       ahaTable.filteredColumns = filters;
  //       imageFilter.dispatchEvent(new Event('input'));
  //
  //   });
  // });
  //
  // // ------------------------------------------
  // // Sorting Tests
  // // ------------------------------------------
  // suite('Sorting - remoteDataSorting1', function () {
  //
  //   var currentTableFixture2;
  //
  //   setup(function (done) {
  //     currentTableFixture = fixture('remoteDataSorting1');
  //     currentTableFixture.tableData = minidata;
  //
  //     currentTableFixture2 = fixture('remoteDataSorting2');
  //     currentTableFixture2.tableData = minidata;
  //
  //
  //     this.timeout(20*1000); // adding table data may take a while
  //     flush(function () { done(); });
  //   });
  //
  //   teardown(function () { });
  //
  //   test('fixture is created', function(done) {
  //     flush(function () {
  //       assert.isTrue(currentTableFixture !== null);
  //       assert.isTrue(currentTableFixture2 !== null);
  //       done();
  //     });
  //   });
  //
  //   test('Send event with combined sort string for one column', function (done) {
  //
  //       var dataTable = currentTableFixture;
  //       var sortHeadingSelector = 'div > div.tr .th:nth-of-type(2) .column-head.sorted-text-hover';
  //       var sortHeading = dataTable.querySelector(sortHeadingSelector);
  //
  //       dataTable.addEventListener('px-sort-change-intent', (evt) => {
  //         assert(true, 'Event is triggered');
  //         assert.equal(evt.detail, '[{"name":"last","direction":"ascending"}]', 'Requesting sort change');
  //         done();
  //       });
  //
  //       sortHeading.dispatchEvent(new Event('click'));
  //   });
  //
  //   test('Send event with combined sort string for one column', function (done) {
  //
  //       var dataTable = currentTableFixture2;
  //       var sortHeadingSelector = 'div > div.tr .th:nth-of-type(2) .column-head.sorted-text-hover';
  //       var sortHeading = dataTable.querySelector(sortHeadingSelector);
  //
  //       sortHeading.dispatchEvent(new Event('click'));
  //
  //       dataTable.addEventListener('px-sort-change-intent', (evt) => {
  //         assert(true, 'Event is triggered');
  //         assert.equal(evt.detail, '[{"name":"last","direction":"descending"}]', 'Requesting sort change');
  //         done();
  //       });
  //
  //       // second click
  //       sortHeading.dispatchEvent(new Event('click'));
  //   });

//   });
//
// });

// function _typeofComparison (val, comparator) {
//   return (typeof val === comparator || false);
// }
